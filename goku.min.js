!function(e){"use strict";function t(e){if(!e)return!0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function i(){return"goku-"+a++}function s(e){if(!e)throw new Error("Goku: no argument");if("string"==typeof e&&(e=document.querySelector(e)),!e)throw new Error("Goku: no element found");if(r[e.dataset.gokuId])return r[e.dataset.gokuId];var s=i();return e.dataset.gokuId=s,r[s]=new Transition(e,{id:s,onstart:function(){o||(console.log("goku.js: start animation loop"),o=u(n))},oncomplete:function(e){var i=e.dataset.gokuId;delete e.dataset.gokuId,delete r[i],t(r)&&(console.log("goku.js: complete animation loop"),h(o),o=null)}}),r[s]}function n(e){o=u(n);for(var t in r)r[t].step&&r[t].step(e)}var o,r={},a=0,u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},h=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){window.clearTimeout(e)};e.goku=s}(window),function(e){"use strict";function t(e,t){t=t||{},this.element=e,this.id=t.id,this.onstart=t.onstart,this.oncomplete=function(){this._clear(),t.oncomplete(this.element)}.bind(this),this.queue=[],this.timings=[],this.playingIndex=-1,this.elapsedTime=0,this.lastTimestamp=0,this.isPaused=!1,this.pausingIndex=-1,this.promiseQueue=[],this.animate=this.animate.bind(this),this.delay=this.delay.bind(this),this.pause=this.pause.bind(this)}var i=400,s="ease";t.prototype={_generatePromiseTask:function(){var e={},t=new Promise(function(t,i){e.resolve=t,e.reject=i});return t.animate=this.animate,t.delay=this.delay,t.pause=this.pause,e.promise=t,e},_generateTransform:function(e,t){var i=getComputedStyle(e).transform;e.style.transform="none"===i?t:i+" "+t},_generateTransformByMatrix:function(){},addClass:function(){},animate:function(){var e=Array.prototype.slice.call(arguments);if(!e[0])throw new Error("Goku: missing arguments!");if("string"==typeof e[0])throw new Error("Goku: implement this!");if("object"==typeof e[0]){var t=e[0],n=e[1]||{},o=[];for(var r in t)o.push(r);var a=o.join(" "),u=n.duration||i;this.timings.push(u);var h=this,l={properties:t,options:n,start:function(){h.element.style.transitionProperty=a,h.element.style.transitionDuration=u+"ms",h.element.style.transitionTimingFunction=n.easing||s,h.element.offsetWidth;for(var e in t)h.element.style[e]="transform"===e?t[e]:t[e];n.start&&n.start()}};this.queue.push(l),1===this.queue.length&&this.onstart();var p=this._generatePromiseTask();return this.promiseQueue.push(p),p.promise}},delay:function(e){if(console.log(this.id,"delay"),!(e>0))throw new Error("Goku: missing arguments!");this.queue.push({}),this.timings.push(e),1===this.queue.length&&this.onstart();var t=this._generatePromiseTask();return this.promiseQueue.push(t),t.promise},pause:function(){return console.log(this.id,"pause"),this.isPaused=!0,this},play:function(){return console.log(this.id,"play"),this.isPaused=!1,this.promiseQueue[this.playingIndex].promise},reset:function(){},reverse:function(){},next:function(){},finish:function(){console.log(this.id,"finish");for(var e=this.queue.length-1,t=this.queue[e].properties;!t;)t=this.queue[e].properties,e-=1;this.element.style.transitionProperty="none";for(var i in t)this.element.style[i]=t[i];this.element.offsetWidth;var s=this.promiseQueue;return this.oncomplete(),s.forEach(function(e){e.resolve()}),this},step:function(e){if(!this.isPaused&&this.lastTimestamp&&(this.elapsedTime+=e-this.lastTimestamp),this.lastTimestamp=e,-1===this.playingIndex)return void this._next();if(!(this.isPaused&&this.pausingIndex>-1)){var t,i,s;if(this.isPaused&&this.pausingIndex<0){this.pausingIndex=this.playingIndex;var n=getComputedStyle(this.element);t=this.queue[this.playingIndex],i=t.properties;for(s in i)this.element.style[s]=n[s]}else if(!this.isPaused&&this.pausingIndex>-1){this.pausingIndex=-1,t=this.queue[this.playingIndex],i=t.properties;for(s in i)this.element.style[s]=i[s]}else if(this.elapsedTime>this.timings[this.playingIndex]){t=this.queue[this.playingIndex],t.options&&"function"==typeof t.options.complete&&t.options.complete();var o=this.promiseQueue[this.playingIndex];o.resolve(),this._next()}}},_next:function(){if(this.playingIndex+=1,this.queue[this.playingIndex]){console.log(this.id,"next");var e=this.queue[this.playingIndex];e.options&&"function"==typeof e.options.before&&e.options.before(),e.start&&"function"==typeof e.start&&e.start(),this.elapsedTime=0,this.lastTimestamp=0}else console.log(this.id,"end"),this.oncomplete()},_clear:function(){console.log(this.id,"clear"),this.playingIndex=-1,this.queue.length=0,this.timings.length=0,this.elapsedTime=0,this.lastTimestamp=0,this.isPaused=!1,this.pausingIndex=-1,this.promiseQueue=[]}},e.Transition=t}(window);
//# sourceMappingURL=maps/goku.min.js.map